[tox]
envlist = py38, py39, py310, py311, py312
isolated_build = true

[testenv]
deps = 
    pytest
    pytest-cov
    coverage[toml]
commands = 
    pytest tests/ --cov=pymars --cov-report=term-missing --cov-report=html
    python -c "import coverage; cov = coverage.Coverage(); cov.load(); print(f'Coverage: {cov.report():.2f}%')"

[testenv:lint]
deps = ruff
commands = 
    ruff check pymars tests
    ruff format --check pymars tests

[testenv:type-check]
deps = 
    mypy
    numpy
    scikit-learn
commands = 
    mypy pymars/

[testenv:format]
deps = 
    ruff
commands = 
    ruff check --fix pymars tests
    ruff format pymars tests

[testenv:docs]
deps = 
    sphinx
commands = 
    sphinx-build -b html docs docs/_build

[testenv:pyright]
deps = 
    pyright
    numpy
    scikit-learn
    matplotlib
commands = 
    pyright pymars/

[testenv:ty]
deps = 
    ty
    numpy
    scikit-learn
    matplotlib
commands = 
    ty pymars/

[testenv:pandera]
deps = 
    pandera>=0.17.0
    numpy
    scikit-learn
    pandas
    pytest
commands = 
    python -c "import pandera as pa; print('pandera version:', pa.__version__)"

[testenv:pydantic]
deps = 
    pydantic>=2.5.0
    numpy
    scikit-learn
    pytest
commands = 
    python -c "import pydantic; print('pydantic version:', pydantic.__version__ if hasattr(pydantic, '__version__') else 'unknown')"

[testenv:nbqa]
deps = 
    nbqa>=1.7.0
    black
    ruff
    numpy
    scikit-learn
    pytest
commands = 
    python -c "import nbqa; print('nbqa imported successfully')"

[testenv:nbstripout]
deps = 
    nbstripout>=0.6.0
commands = 
    python -c "import subprocess; result = subprocess.run(['nbstripout', '--help'], capture_output=True, text=True); print('nbstripout available:', result.returncode == 0)"

[testenv:syrupy]
deps = 
    syrupy>=4.0.0
    numpy
    scikit-learn
    pytest
commands = 
    python -c "import syrupy; print('syrupy version:', getattr(syrupy, '__version__', 'unknown'))"

[testenv:lizard]
deps = 
    lizard>=1.17.0
commands = 
    python -c "import subprocess; result = subprocess.run(['python', '-m', 'lizard', '--help'], capture_output=True, text=True); print('lizard available:', result.returncode == 0)"